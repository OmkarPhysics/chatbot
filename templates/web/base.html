<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>{% block title %}DRF Email Auth{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
      body { max-width: 960px; margin: 0 auto; padding: 24px; }
      pre { background: #0b1020; color: #e6e6e6; padding: 12px; border-radius: 8px; overflow: auto; }
      .muted { color: #666; font-size: 0.9em; }
    </style>
  </head>
  <body>
    <h1><a href="/">DRF Email Auth</a></h1>
    <p class="muted">These pages call the JSON API under <code>/api/</code>.</p>
    {% block content %}{% endblock %}
    <script>
      function setTokens(data) {
        if (data && data.access) localStorage.setItem("access", data.access);
        if (data && data.refresh) localStorage.setItem("refresh", data.refresh);
      }
      function getAccess() { return localStorage.getItem("access"); }
      function getRefresh() { return localStorage.getItem("refresh"); }
      function clearTokens() { localStorage.removeItem("access"); localStorage.removeItem("refresh"); }
      async function api(path, { method="GET", body=null, isForm=false } = {}) {
        const headers = {};
        const access = getAccess();
        if (access) headers["Authorization"] = `Bearer ${access}`;
        if (!isForm) headers["Content-Type"] = "application/json";
        const res = await fetch(path, {
          method,
          headers,
          body: body ? (isForm ? body : JSON.stringify(body)) : null
        });
        const text = await res.text();
        let json = null;
        try { json = text ? JSON.parse(text) : null; } catch (_) {}
        return { ok: res.ok, status: res.status, text, json };
      }
      function show(elId, obj) {
        const el = document.getElementById(elId);
        if (!el) return;
        el.textContent = typeof obj === "string" ? obj : JSON.stringify(obj, null, 2);
      }
    </script>
    {% block scripts %}{% endblock %}
  </body>
</html>

